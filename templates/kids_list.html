{% extends "base.html" %}

{% block title %}Kids List - JT KIDZ{% endblock %}

{% block content %}
<div class="mb-6">
    <div class="flex justify-between items-center">
        <h1 class="text-3xl font-bold text-gray-800">Kids Management</h1>
        <a href="{{ url_for('kids.add_kid') }}" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-6 rounded-lg">
            ‚ûï Add New Kid
        </a>
    </div>
</div>

<div class="bg-white rounded-lg shadow-md p-6 mb-6">
    <form method="GET" class="flex flex-wrap gap-4">
        <div class="flex-1 min-w-[200px]">
            <label class="block text-sm font-medium text-gray-700 mb-1">Site</label>
            <select name="site" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                <option value="">All Sites</option>
                {% for site in sites %}
                <option value="{{ site }}" {% if site == current_site %}selected{% endif %}>{{ site }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="flex-1 min-w-[200px]">
            <label class="block text-sm font-medium text-gray-700 mb-1">Age Group</label>
            <select name="age_group" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                <option value="">All Age Groups</option>
                <option value="kids" {% if current_age_group == 'kids' %}selected{% endif %}>Kids (3-8)</option>
                <option value="risers" {% if current_age_group == 'risers' %}selected{% endif %}>Risers (9-11)</option>
                <option value="teens" {% if current_age_group == 'teens' %}selected{% endif %}>Teens (12-14)</option>
                <option value="other" {% if current_age_group == 'other' %}selected{% endif %}>Other</option>
            </select>
        </div>
        <div class="flex-1 min-w-[200px]">
            <label class="block text-sm font-medium text-gray-700 mb-1">Status</label>
            <select name="status" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                <option value="active" {% if current_status == 'active' %}selected{% endif %}>Active</option>
                <option value="inactive" {% if current_status == 'inactive' %}selected{% endif %}>Inactive</option>
                <option value="">All</option>
            </select>
        </div>
        <div class="flex items-end">
            <button type="submit" class="bg-gray-600 hover:bg-gray-700 text-white font-semibold py-2 px-6 rounded-lg">
                Filter
            </button>
        </div>
    </form>
</div>

<div class="bg-white rounded-lg shadow-md overflow-hidden">
    <div class="overflow-x-auto">
        <table class="w-full">
            <thead class="bg-gray-50">
                <tr>
                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Photo</th>
                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Barcode</th>
                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Name</th>
                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Gender</th>
                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Age</th>
                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Age Group</th>
                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Site</th>
                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Status</th>
                    <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Actions</th>
                </tr>
            </thead>
            <tbody class="divide-y divide-gray-200">
                {% if kids %}
                    {% for kid in kids %}
                    <tr class="hover:bg-gray-50">
                        <td class="px-4 py-3">
                            {% if kid.profile_pic %}
                            <img src="{{ url_for('static', filename='img/profiles/' + kid.profile_pic) }}" 
                                 alt="{{ kid.full_name }}" 
                                 class="w-12 h-12 object-cover rounded-full border-2 border-gray-300">
                            {% else %}
                            <div class="w-12 h-12 bg-gray-200 rounded-full flex items-center justify-center border-2 border-gray-300">
                                <span class="text-gray-500 font-semibold text-lg">{{ kid.full_name[0] }}</span>
                            </div>
                            {% endif %}
                        </td>
                        <td class="px-4 py-3 text-sm font-mono">{{ kid.barcode }}</td>
                        <td class="px-4 py-3 text-sm font-medium">{{ kid.full_name }}</td>
                        <td class="px-4 py-3 text-sm">
                            {% if kid.gender == 'Male' %}
                            <span class="text-blue-600">üë¶ {{ kid.gender }}</span>
                            {% elif kid.gender == 'Female' %}
                            <span class="text-pink-600">üëß {{ kid.gender }}</span>
                            {% else %}
                            <span class="text-gray-500">-</span>
                            {% endif %}
                        </td>
                        <td class="px-4 py-3 text-sm">{{ kid.age }}</td>
                        <td class="px-4 py-3 text-sm">
                            <span class="{% if kid.age_group == 'Kids (3-8)' %}bg-blue-100 text-blue-800{% elif kid.age_group == 'Risers (9-11)' %}bg-green-100 text-green-800{% elif kid.age_group == 'Teens (12-14)' %}bg-purple-100 text-purple-800{% else %}bg-gray-100 text-gray-800{% endif %} text-xs font-semibold px-2 py-1 rounded">
                                {{ kid.age_group }}
                            </span>
                        </td>
                        <td class="px-4 py-3 text-sm">{{ kid.site }}</td>
                        <td class="px-4 py-3 text-sm">
                            {% if kid.status == 'active' %}
                            <span class="bg-green-100 text-green-800 text-xs font-semibold px-2 py-1 rounded">Active</span>
                            {% else %}
                            <span class="bg-gray-100 text-gray-800 text-xs font-semibold px-2 py-1 rounded">Inactive</span>
                            {% endif %}
                        </td>
                        <td class="px-4 py-3 text-sm">
                            <div class="flex space-x-2">
                                <a href="{{ url_for('kids.view_barcode', kid_id=kid.id) }}" class="text-blue-600 hover:text-blue-800" title="View Barcode">üîç</a>
                                <a href="{{ url_for('kids.edit_kid', kid_id=kid.id) }}" class="text-yellow-600 hover:text-yellow-800" title="Edit">‚úèÔ∏è</a>
                                {% if kid.status == 'active' %}
                                <a href="{{ url_for('kids.deactivate_kid', kid_id=kid.id) }}" class="text-red-600 hover:text-red-800" onclick="return confirm('Deactivate this kid?')" title="Deactivate">‚ùå</a>
                                {% else %}
                                <a href="{{ url_for('kids.activate_kid', kid_id=kid.id) }}" class="text-green-600 hover:text-green-800" title="Activate">‚úÖ</a>
                                {% endif %}
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                {% else %}
                    <tr>
                        <td colspan="6" class="px-4 py-8 text-center text-gray-500">
                            No kids found. <a href="{{ url_for('kids.add_kid') }}" class="text-blue-600 hover:underline">Add your first kid</a>
                        </td>
                    </tr>
                {% endif %}
            </tbody>
        </table>
    </div>
</div>

<div class="mt-4 text-gray-600">
    <p>Total: {{ kids|length }} kid(s)</p>
</div>
{% endblock %}
